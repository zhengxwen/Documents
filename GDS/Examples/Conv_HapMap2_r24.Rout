
R version 3.1.2 (2014-10-31) -- "Pumpkin Helmet"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #########################################################################
> ##
> ##  Convert HapMap2_r24 Genotypes to GDS Format
> ##  File: Conv_HapMap2_r24.R
> ##  Output: HapMap2_r24_nr_b36_fwd.gds
> ##
> 
> library(gdsfmt)
> library(SNPRelate)
SNPRelate -- supported by Streaming SIMD Extensions 2 (SSE2)
> 
> 
> # file name template
> FILE_TEMPLATE <- "genotypes_chr%s_%s_r24_nr.b36_fwd.txt.gz"
> 
> 
> 
> #########################################################################
> ##  Download the gz files from HapMap Website
> 
> FTP_BASE <- "ftp://ftp.ncbi.nlm.nih.gov/hapmap/"
> FTP_GENO_PATH <- "genotypes/2008-10_phaseII/fwd_strand/non-redundant"
> 
> for (chr.id in c(1:22, "X", "Y", "M"))
+ {
+ 	for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 	{
+ 		fn <- sprintf(FILE_TEMPLATE, chr.id, pop)
+ 		ftp.fn <- file.path(FTP_BASE, FTP_GENO_PATH, fn)
+ 		if (!file.exists(fn))
+ 			download.file(ftp.fn, fn)
+ 	}
+ }
trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr1_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 11847682 bytes
opened URL
==================================================
downloaded 11.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr1_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 11800014 bytes
opened URL
==================================================
downloaded 11.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr1_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 12560328 bytes
opened URL
==================================================
downloaded 12.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr2_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 12406236 bytes
opened URL
==================================================
downloaded 11.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr2_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 12154690 bytes
opened URL
==================================================
downloaded 11.6 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr2_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 13218329 bytes
opened URL
==================================================
downloaded 12.6 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr3_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10193469 bytes
opened URL
==================================================
downloaded 9.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr3_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 9958725 bytes
opened URL
==================================================
downloaded 9.5 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr3_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10594855 bytes
opened URL
==================================================
downloaded 10.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr4_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 9607127 bytes
opened URL
==================================================
downloaded 9.2 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr4_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 9540778 bytes
opened URL
==================================================
downloaded 9.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr4_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10201243 bytes
opened URL
==================================================
downloaded 9.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr5_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 9672455 bytes
opened URL
==================================================
downloaded 9.2 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr5_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 9480642 bytes
opened URL
==================================================
downloaded 9.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr5_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10131468 bytes
opened URL
==================================================
downloaded 9.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr6_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10473855 bytes
opened URL
==================================================
downloaded 10.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr6_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10351432 bytes
opened URL
==================================================
downloaded 9.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr6_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 10826373 bytes
opened URL
==================================================
downloaded 10.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr7_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8421916 bytes
opened URL
==================================================
downloaded 8.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr7_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8283546 bytes
opened URL
==================================================
downloaded 7.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr7_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8773643 bytes
opened URL
==================================================
downloaded 8.4 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr8_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8141889 bytes
opened URL
==================================================
downloaded 7.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr8_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8152225 bytes
opened URL
==================================================
downloaded 7.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr8_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8688172 bytes
opened URL
==================================================
downloaded 8.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr9_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 6934513 bytes
opened URL
==================================================
downloaded 6.6 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr9_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 6957025 bytes
opened URL
==================================================
downloaded 6.6 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr9_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7302416 bytes
opened URL
==================================================
downloaded 7.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr10_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8097227 bytes
opened URL
==================================================
downloaded 7.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr10_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8062041 bytes
opened URL
==================================================
downloaded 7.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr10_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 8317004 bytes
opened URL
==================================================
downloaded 7.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr11_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7791379 bytes
opened URL
==================================================
downloaded 7.4 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr11_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7750876 bytes
opened URL
==================================================
downloaded 7.4 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr11_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7950881 bytes
opened URL
==================================================
downloaded 7.6 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr12_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7451932 bytes
opened URL
==================================================
downloaded 7.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr12_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7410922 bytes
opened URL
==================================================
downloaded 7.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr12_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 7612395 bytes
opened URL
==================================================
downloaded 7.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr13_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 6044780 bytes
opened URL
==================================================
downloaded 5.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr13_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 5993680 bytes
opened URL
==================================================
downloaded 5.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr13_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 6233306 bytes
opened URL
==================================================
downloaded 5.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr14_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4743170 bytes
opened URL
==================================================
downloaded 4.5 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr14_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4709386 bytes
opened URL
==================================================
downloaded 4.5 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr14_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4893195 bytes
opened URL
==================================================
downloaded 4.7 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr15_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4179166 bytes
opened URL
==================================================
downloaded 4.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr15_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4166745 bytes
opened URL
==================================================
downloaded 4.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr15_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4306272 bytes
opened URL
==================================================
downloaded 4.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr16_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4310930 bytes
opened URL
==================================================
downloaded 4.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr16_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4257538 bytes
opened URL
==================================================
downloaded 4.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr16_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4421988 bytes
opened URL
==================================================
downloaded 4.2 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr17_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 3514084 bytes
opened URL
==================================================
downloaded 3.4 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr17_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 3419297 bytes
opened URL
==================================================
downloaded 3.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr17_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 3563874 bytes
opened URL
==================================================
downloaded 3.4 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr18_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4471701 bytes
opened URL
==================================================
downloaded 4.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr18_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4486849 bytes
opened URL
==================================================
downloaded 4.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr18_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4749685 bytes
opened URL
==================================================
downloaded 4.5 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr19_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2268187 bytes
opened URL
==================================================
downloaded 2.2 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr19_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2241045 bytes
opened URL
==================================================
downloaded 2.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr19_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2269271 bytes
opened URL
==================================================
downloaded 2.2 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr20_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4162461 bytes
opened URL
==================================================
downloaded 4.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr20_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4086479 bytes
opened URL
==================================================
downloaded 3.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr20_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4279078 bytes
opened URL
==================================================
downloaded 4.1 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr21_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 1917099 bytes
opened URL
==================================================
downloaded 1.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr21_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 1959444 bytes
opened URL
==================================================
downloaded 1.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr21_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 1990881 bytes
opened URL
==================================================
downloaded 1.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr22_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2019383 bytes
opened URL
==================================================
downloaded 1.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr22_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2036862 bytes
opened URL
==================================================
downloaded 1.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chr22_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 2102707 bytes
opened URL
==================================================
downloaded 2.0 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrX_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4076832 bytes
opened URL
==================================================
downloaded 3.9 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrX_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4013919 bytes
opened URL
==================================================
downloaded 3.8 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrX_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 4559778 bytes
opened URL
==================================================
downloaded 4.3 Mb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrY_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 27610 bytes
opened URL
==================================================
downloaded 26 Kb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrY_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 25843 bytes
opened URL
==================================================
downloaded 25 Kb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrY_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 25071 bytes
opened URL
==================================================
downloaded 24 Kb

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrM_CEU_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 5477 bytes
opened URL
==================================================
downloaded 5477 bytes

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrM_JPT+CHB_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 5323 bytes
opened URL
==================================================
downloaded 5323 bytes

trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//genotypes/2008-10_phaseII/fwd_strand/non-redundant/genotypes_chrM_YRI_r24_nr.b36_fwd.txt.gz'
ftp data connection made, file length 6101 bytes
opened URL
==================================================
downloaded 6101 bytes

> 
> # E.g., genotypes_chr1_CEU_r24_nr.b36_fwd.txt.gz:
> #
> # Col1: refSNP rs# identifier at the time of release (NB might merge 
> #       with another rs# in the future)
> # Col2: SNP alleles according to dbSNP
> # Col3: chromosome that SNP maps to 
> # Col4: chromosome position of SNP, in basepairs on reference sequence
> # Col5: strand of reference sequence that SNP maps to
> # Col6: version of reference sequence assembly (currently NCBI build36)
> # Col7: HapMap genotyping center that produced the genotypes
> # Col8: LSID for HapMap protocol used for genotyping
> # Col9: LSID for HapMap assay used for genotyping
> # Col10: LSID for panel of individuals genotyped
> # Col11: QC-code, currently 'QC+' for all entries (for future use)
> # Col12 and on: observed genotypes of samples, one per column, sample
> #       identifiers in column headers (Coriell catalog numbers, example:
> #       NA10847). Duplicate samples have .dup suffix.
> 
> 
> # download the sample annotation file
> FTP_SAMP_PATH <- "samples_individuals"
> sample.fn <- "relationships_w_pops_121708.txt"
> download.file(file.path(FTP_BASE, FTP_SAMP_PATH, sample.fn), sample.fn)
trying URL 'ftp://ftp.ncbi.nlm.nih.gov/hapmap//samples_individuals/relationships_w_pops_121708.txt'
ftp data connection made, file length 36765 bytes
opened URL
==================================================
downloaded 35 Kb

> 
> head(read.table(sample.fn, header=TRUE, stringsAsFactors=FALSE))
   FID     IID     dad     mom sex pheno population
1 2357 NA19625       0       0   2     0        ASW
2 2367 NA19702 NA19700 NA19701   1     0        ASW
3 2367 NA19700       0       0   1     0        ASW
4 2367 NA19701       0       0   2     0        ASW
5 2368 NA19705 NA19703 NA19704   1     0        ASW
6 2368 NA19703       0       0   1     0        ASW
> #    FID     IID     dad     mom sex pheno population
> 
> 
> #########################################################################
> ##  Get HapMap individual IDs
> 
> SampID_File <- function(chr.id)
+ {
+ 	ans <- c()
+ 	for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 	{
+ 		fn <- sprintf(FILE_TEMPLATE, "1", pop)
+ 		tab <- read.table(fn, header=TRUE, comment.char="",
+ 			stringsAsFactors=FALSE, nrows=2)
+ 		ans <- c(ans, colnames(tab)[-(1:11)])
+ 	}
+ 	ans
+ }
> 
> sample.id <- SampID_File("1")
> 
> # check individual orders
> for (chr.id in c(2:22, "X", "Y", "M"))
+ {
+ 	s <- SampID_File(chr.id)
+ 	if (!identical(sample.id, s))
+ 		stop("Individual IDs are not consistent among chromosomes.")
+ 	cat(sprintf("Chromosome %s: OK\n", chr.id))
+ }
Chromosome 2: OK
Chromosome 3: OK
Chromosome 4: OK
Chromosome 5: OK
Chromosome 6: OK
Chromosome 7: OK
Chromosome 8: OK
Chromosome 9: OK
Chromosome 10: OK
Chromosome 11: OK
Chromosome 12: OK
Chromosome 13: OK
Chromosome 14: OK
Chromosome 15: OK
Chromosome 16: OK
Chromosome 17: OK
Chromosome 18: OK
Chromosome 19: OK
Chromosome 20: OK
Chromosome 21: OK
Chromosome 22: OK
Chromosome X: OK
Chromosome Y: OK
Chromosome M: OK
> 
> 
> 
> #########################################################################
> ##  Create GDS file
> 
> # Create a new GDS file
> gds.fn <- "HapMap2_r24_nr_b36_fwd.gds"
> newfile <- createfn.gds(gds.fn)
> 
> # Add a format flag
> put.attr.gdsn(newfile$root, "FileFormat", "SNP_ARRAY")
> 
> # Add variables
> add.gdsn(newfile, "sample.id", sample.id, compress="ZIP_RA.max",
+ 	closezip=TRUE)
> var.snp <- add.gdsn(newfile, "snp.id", valdim=0L, storage="int",
+ 	compress="ZIP_RA.max")
> var.rsid <- add.gdsn(newfile, "snp.rs.id", valdim=0L, storage="string",
+ 	compress="ZIP_RA.max")
> var.chr <- add.gdsn(newfile, "snp.chromosome", valdim=0L, storage="string",
+ 	compress="ZIP_RA.max")
> var.pos <- add.gdsn(newfile, "snp.position", valdim=0L, storage="int",
+ 	compress="ZIP_RA.max")
> var.allele <- add.gdsn(newfile, "snp.allele", valdim=0L, storage="string",
+ 	compress="ZIP_RA.max")
> 
> # Add genotypes
> var.geno <- add.gdsn(newfile, "genotype", valdim=c(length(sample.id), 0),
+ 	storage="bit2", compress="ZIP_RA.max")
> 
> # Indicate the SNP matrix is sample-by-snp
> put.attr.gdsn(var.geno, "sample.order")
> 
> # initial var.
> n.int <- 0L
> 
> cat("Starting ...\n")
Starting ...
> 
> # Write SNPs into the GDS file
> for (chr.id in c(1:22, "X", "Y", "M"))
+ {
+ 	v <- list()
+ 	for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 	{
+ 		fn <- sprintf(FILE_TEMPLATE, chr.id, pop)
+ 		cat("Read:", fn)
+ 		v[[pop]] <- read.table(fn, header=TRUE, comment.char="",
+ 			stringsAsFactors=FALSE)
+ 		cat(",", dim(v[[pop]]), "\n")
+ 	}
+ 
+ 	common.pos <- intersect(v[["CEU"]]$pos, v[["JPT+CHB"]]$pos)
+ 	common.pos <- intersect(common.pos, v[["YRI"]]$pos)
+ 	common.pos <- common.pos[order(common.pos)]
+ 	cat("\tPosition Intersect:", length(common.pos), "\n")
+ 	for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 		v[[pop]] <- v[[pop]][match(common.pos, v[[pop]]$pos), ]
+ 
+ 	common.rs. <- intersect(v[["CEU"]]$rs., v[["JPT+CHB"]]$rs.)
+ 	common.rs. <- intersect(common.rs., v[["YRI"]]$rs.)
+ 	cat("\tRS ID Intersect:", length(common.rs.), "\n")
+ 	for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 		v[[pop]] <- v[[pop]][match(common.rs., v[[pop]]$rs.), ]
+ 
+ 	stopifnot(identical(v[["CEU"]]$SNPalleles, v[["JPT+CHB"]]$SNPalleles))
+ 	stopifnot(identical(v[["CEU"]]$SNPalleles, v[["YRI"]]$SNPalleles))
+ 	cat("\tSNP alleles:")
+ 	print(table(v[["CEU"]]$SNPalleles))
+ 
+ 	# detect and remove non-standard alleles
+ 	allele <- v[["CEU"]]$SNPalleles
+ 	s <- strsplit(allele, "/")
+ 	flag <- sapply(s, function(x)
+ 		(length(x)==2L) & all(x %in% c("A", "G", "C", "T")))
+ 	if (sum(!flag) > 0)
+ 	{
+ 		for (pop in c("CEU", "JPT+CHB", "YRI"))
+ 			v[[pop]] <- v[[pop]][flag, ]
+ 		allele <- v[["CEU"]]$SNPalleles
+ 		cat(sprintf("\tRemove non-standard alleles (%d):", sum(!flag)))
+ 		print(table(v[["CEU"]]$SNPalleles))
+ 	}
+ 
+ 	# snp.id
+ 	n <- dim(v$CEU)[1]
+ 	append.gdsn(var.snp, seq_len(n) + n.int)
+ 	n.int <- n.int + n
+ 
+ 	# snp.rs.id
+ 	append.gdsn(var.rsid, v[["CEU"]]$rs.)
+ 
+ 	# snp.chromosome
+ 	append.gdsn(var.chr, rep(chr.id, n))
+ 
+ 	# snp.position
+ 	append.gdsn(var.pos, v[["CEU"]]$pos)
+ 
+ 	# snp.allele
+ 	append.gdsn(var.allele, allele)
+ 
+ 	s <- strsplit(allele, "/")
+ 	g0  <- sapply(s, function(x) paste0(x[2],x[2]))
+ 	g1a <- sapply(s, function(x) paste0(x[1],x[2]))
+ 	g1b <- sapply(s, function(x) paste0(x[2],x[1]))
+ 	g2  <- sapply(s, function(x) paste0(x[1],x[1]))
+ 	gNN <- rep("NN", length(allele))
+ 
+ 	# genotype
+ 	m <- cbind(as.matrix(v[["CEU"]][, -c(1:11)]),
+ 		as.matrix(v[["JPT+CHB"]][, -c(1:11)]),
+ 		as.matrix(v[["YRI"]][, -c(1:11)]))
+ 	f0  <- (m == g0)
+ 	f1a <- (m == g1a)
+ 	f1b <- (m == g1b)
+ 	f2  <- (m == g2)
+ 	fNN <- (m == gNN)
+ 	if (!all(f0 | f1a | f1b | f2 | fNN))
+ 		stop("Invalid SNP genotypes")
+ 
+ 	g <- 2L*f2 + f1a + f1b
+ 	g[fNN] <- 3L
+ 	cat("\tGenotypes:")
+ 	print(table(c(g)))
+ 
+ 	append.gdsn(var.geno, t(g))
+ 	cat("\n")
+ }
Read: genotypes_chr1_CEU_r24_nr.b36_fwd.txt.gz, 307691 101 
Read: genotypes_chr1_JPT+CHB_r24_nr.b36_fwd.txt.gz, 311854 101 
Read: genotypes_chr1_YRI_r24_nr.b36_fwd.txt.gz, 305929 101 
	Position Intersect: 293961 
	RS ID Intersect: 293961 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
25322 98927 19590 25049 99678 25395 
	Genotypes:
       0        1        2        3 
31353638 15375804 31292006  1348022 

Read: genotypes_chr2_CEU_r24_nr.b36_fwd.txt.gz, 326231 101 
Read: genotypes_chr2_JPT+CHB_r24_nr.b36_fwd.txt.gz, 327180 101 
Read: genotypes_chr2_YRI_r24_nr.b36_fwd.txt.gz, 318602 101 
	Position Intersect: 311138 
	RS ID Intersect: 311138 
	SNP alleles:
   A/C    A/G    A/T    C/G    C/T    G/T 
 27201 103762  21240  27644 104050  27241 
	Genotypes:
       0        1        2        3 
32613209 17657338 32574767  1161946 

Read: genotypes_chr3_CEU_r24_nr.b36_fwd.txt.gz, 255391 101 
Read: genotypes_chr3_JPT+CHB_r24_nr.b36_fwd.txt.gz, 255618 101 
Read: genotypes_chr3_YRI_r24_nr.b36_fwd.txt.gz, 250155 101 
	Position Intersect: 240048 
	RS ID Intersect: 240048 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
21686 79798 16510 21496 79053 21505 
	Genotypes:
       0        1        2        3 
25043393 13818481 24903744  1047342 

Read: genotypes_chr4_CEU_r24_nr.b36_fwd.txt.gz, 244849 101 
Read: genotypes_chr4_JPT+CHB_r24_nr.b36_fwd.txt.gz, 245102 101 
Read: genotypes_chr4_YRI_r24_nr.b36_fwd.txt.gz, 238922 101 
	Position Intersect: 229888 
	RS ID Intersect: 229888 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
20678 75894 17043 18947 76326 21000 
	Genotypes:
       0        1        2        3 
24073953 12824498 24003056  1168253 

Read: genotypes_chr5_CEU_r24_nr.b36_fwd.txt.gz, 247632 101 
Read: genotypes_chr5_JPT+CHB_r24_nr.b36_fwd.txt.gz, 248154 101 
Read: genotypes_chr5_YRI_r24_nr.b36_fwd.txt.gz, 242186 101 
	Position Intersect: 234786 
	RS ID Intersect: 234786 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
21365 77624 16895 20397 77449 21056 
	Genotypes:
       0        1        2        3 
24562687 13303184 24506196  1020153 

Read: genotypes_chr6_CEU_r24_nr.b36_fwd.txt.gz, 268348 101 
Read: genotypes_chr6_JPT+CHB_r24_nr.b36_fwd.txt.gz, 272814 101 
Read: genotypes_chr6_YRI_r24_nr.b36_fwd.txt.gz, 265955 101 
	Position Intersect: 256301 
	RS ID Intersect: 256301 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
22002 86446 17841 21318 86260 22434 
	Genotypes:
       0        1        2        3 
27007124 14169112 26961502  1063532 

Read: genotypes_chr7_CEU_r24_nr.b36_fwd.txt.gz, 213023 101 
Read: genotypes_chr7_JPT+CHB_r24_nr.b36_fwd.txt.gz, 213891 101 
Read: genotypes_chr7_YRI_r24_nr.b36_fwd.txt.gz, 208708 101 
	Position Intersect: 200508 
	RS ID Intersect: 200508 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
17670 65848 14040 18050 67021 17879 
	Genotypes:
       0        1        2        3 
21029169 11198998 20962212   946781 

Read: genotypes_chr8_CEU_r24_nr.b36_fwd.txt.gz, 213095 101 
Read: genotypes_chr8_JPT+CHB_r24_nr.b36_fwd.txt.gz, 216811 101 
Read: genotypes_chr8_YRI_r24_nr.b36_fwd.txt.gz, 212014 101 
	Position Intersect: 202138 
	RS ID Intersect: 202138 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
18311 65515 14452 19892 66169 17799 
	Genotypes:
       0        1        2        3 
21114323 11756971 20954509   751457 

Read: genotypes_chr9_CEU_r24_nr.b36_fwd.txt.gz, 181445 101 
Read: genotypes_chr9_JPT+CHB_r24_nr.b36_fwd.txt.gz, 183433 101 
Read: genotypes_chr9_YRI_r24_nr.b36_fwd.txt.gz, 180147 101 
	Position Intersect: 171793 
	RS ID Intersect: 171793 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
14961 56247 11616 17277 56861 14831 
	Genotypes:
       0        1        2        3 
18076595  9589741 18028566   689208 

Read: genotypes_chr10_CEU_r24_nr.b36_fwd.txt.gz, 209342 101 
Read: genotypes_chr10_JPT+CHB_r24_nr.b36_fwd.txt.gz, 211862 101 
Read: genotypes_chr10_YRI_r24_nr.b36_fwd.txt.gz, 204146 101 
	Position Intersect: 196093 
	RS ID Intersect: 196090 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
16793 65906 12770 17127 66540 16954 
	Genotypes:
       0        1        2        3 
20848586 10424637 20737507   933570 

Read: genotypes_chr11_CEU_r24_nr.b36_fwd.txt.gz, 204228 101 
Read: genotypes_chr11_JPT+CHB_r24_nr.b36_fwd.txt.gz, 205538 101 
Read: genotypes_chr11_YRI_r24_nr.b36_fwd.txt.gz, 195110 101 
	Position Intersect: 189512 
	RS ID Intersect: 189511 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
17589 62530 12788 16710 62433 17461 
	Genotypes:
       0        1        2        3 
20224947  9898324 20139379   905320 

Read: genotypes_chr12_CEU_r24_nr.b36_fwd.txt.gz, 191979 101 
Read: genotypes_chr12_JPT+CHB_r24_nr.b36_fwd.txt.gz, 193071 101 
Read: genotypes_chr12_YRI_r24_nr.b36_fwd.txt.gz, 187294 101 
	Position Intersect: 175487 
	RS ID Intersect: 175487 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
15419 59314 11592 15196 58715 15251 
	Genotypes:
       0        1        2        3 
18711609  9171176 18627721   870984 

Read: genotypes_chr13_CEU_r24_nr.b36_fwd.txt.gz, 155905 101 
Read: genotypes_chr13_JPT+CHB_r24_nr.b36_fwd.txt.gz, 158406 101 
Read: genotypes_chr13_YRI_r24_nr.b36_fwd.txt.gz, 152674 101 
	Position Intersect: 146362 
	RS ID Intersect: 146359 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
12852 49245 10678 11899 48806 12879 
	Genotypes:
       0        1        2        3 
15406596  7939618 15508206   662510 

Read: genotypes_chr14_CEU_r24_nr.b36_fwd.txt.gz, 123071 101 
Read: genotypes_chr14_JPT+CHB_r24_nr.b36_fwd.txt.gz, 123764 101 
Read: genotypes_chr14_YRI_r24_nr.b36_fwd.txt.gz, 118518 101 
	Position Intersect: 114921 
	RS ID Intersect: 114921 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
10027 38437  7984 10185 38039 10249 
	Genotypes:
       0        1        2        3 
12002642  6454026 12117533   454469 

Read: genotypes_chr15_CEU_r24_nr.b36_fwd.txt.gz, 106814 101 
Read: genotypes_chr15_JPT+CHB_r24_nr.b36_fwd.txt.gz, 107363 101 
Read: genotypes_chr15_YRI_r24_nr.b36_fwd.txt.gz, 102431 101 
	Position Intersect: 99440 
	RS ID Intersect: 99440 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 8568 33091  6411  9695 33171  8504 
	Genotypes:
       0        1        2        3 
10396930  5650682 10373528   427660 

Read: genotypes_chr16_CEU_r24_nr.b36_fwd.txt.gz, 109692 101 
Read: genotypes_chr16_JPT+CHB_r24_nr.b36_fwd.txt.gz, 109734 101 
Read: genotypes_chr16_YRI_r24_nr.b36_fwd.txt.gz, 104530 101 
	Position Intersect: 101193 
	RS ID Intersect: 101193 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 8754 32841  6209 12630 31941  8818 
	Genotypes:
       0        1        2        3 
10574295  5484275 10756766   506774 

Read: genotypes_chr17_CEU_r24_nr.b36_fwd.txt.gz, 89701 101 
Read: genotypes_chr17_JPT+CHB_r24_nr.b36_fwd.txt.gz, 89576 101 
Read: genotypes_chr17_YRI_r24_nr.b36_fwd.txt.gz, 85541 101 
	Position Intersect: 82941 
	RS ID Intersect: 82941 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 6876 28499  4919  7597 28241  6809 
	Genotypes:
      0       1       2       3 
8792301 4504001 8703914  393854 

Read: genotypes_chr18_CEU_r24_nr.b36_fwd.txt.gz, 119118 101 
Read: genotypes_chr18_JPT+CHB_r24_nr.b36_fwd.txt.gz, 120025 101 
Read: genotypes_chr18_YRI_r24_nr.b36_fwd.txt.gz, 115768 101 
	Position Intersect: 110859 
	RS ID Intersect: 110859 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
10224 36810  7810  9067 36821 10127 
	Genotypes:
       0        1        2        3 
11728352  5962780 11762914   477884 

Read: genotypes_chr19_CEU_r24_nr.b36_fwd.txt.gz, 56607 101 
Read: genotypes_chr19_JPT+CHB_r24_nr.b36_fwd.txt.gz, 56687 101 
Read: genotypes_chr19_YRI_r24_nr.b36_fwd.txt.gz, 53766 101 
	Position Intersect: 51739 
	RS ID Intersect: 51739 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 4198 17686  2802  5141 17583  4329 
	Genotypes:
      0       1       2       3 
5416329 2877886 5435145  240170 

Read: genotypes_chr20_CEU_r24_nr.b36_fwd.txt.gz, 119921 101 
Read: genotypes_chr20_JPT+CHB_r24_nr.b36_fwd.txt.gz, 119989 101 
Read: genotypes_chr20_YRI_r24_nr.b36_fwd.txt.gz, 115921 101 
	Position Intersect: 112857 
	RS ID Intersect: 112857 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 8392 41376  5302  8266 40601  8920 
	Genotypes:
       0        1        2        3 
12511508  4877837 12678425   403620 

Read: genotypes_chr21_CEU_r24_nr.b36_fwd.txt.gz, 50165 101 
Read: genotypes_chr21_JPT+CHB_r24_nr.b36_fwd.txt.gz, 51900 101 
Read: genotypes_chr21_YRI_r24_nr.b36_fwd.txt.gz, 49154 101 
	Position Intersect: 45882 
	RS ID Intersect: 45882 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 4004 15312  3161  3866 15635  3904 
	Genotypes:
      0       1       2       3 
4789336 2653822 4751773  193209 

Read: genotypes_chr22_CEU_r24_nr.b36_fwd.txt.gz, 54786 101 
Read: genotypes_chr22_JPT+CHB_r24_nr.b36_fwd.txt.gz, 56716 101 
Read: genotypes_chr22_YRI_r24_nr.b36_fwd.txt.gz, 54840 101 
	Position Intersect: 51386 
	RS ID Intersect: 51386 
	SNP alleles:
  A/C   A/G   A/T   C/G   C/T   G/T 
 4112 17683  2560  5236 17742  4053 
	Genotypes:
      0       1       2       3 
5606161 2516052 5549585  202422 

Read: genotypes_chrX_CEU_r24_nr.b36_fwd.txt.gz, 119769 101 
Read: genotypes_chrX_JPT+CHB_r24_nr.b36_fwd.txt.gz, 120666 101 
Read: genotypes_chrX_YRI_r24_nr.b36_fwd.txt.gz, 118973 101 
	Position Intersect: 115233 
	RS ID Intersect: 115226 
	SNP alleles:
         A/C        A/C/G      A/C/G/T          A/G        A/G/T          A/T 
       10716            3            2        37324            3         8836 
         C/G        C/G/T          C/T     -/C/T/TT          G/T -/G/T/TATTAT 
       10467            4        37088            1        10781            1 
	Remove non-standard alleles (14):
  A/C   A/G   A/T   C/G   C/T   G/T 
10716 37324  8836 10467 37088 10781 
	Genotypes:
       0        1        2        3 
14021749  2748295 13873765   463431 

Read: genotypes_chrY_CEU_r24_nr.b36_fwd.txt.gz, 672 101 
Read: genotypes_chrY_JPT+CHB_r24_nr.b36_fwd.txt.gz, 667 101 
Read: genotypes_chrY_YRI_r24_nr.b36_fwd.txt.gz, 668 101 
	Position Intersect: 651 
	RS ID Intersect: 651 
	SNP alleles:
A/C A/G A/T C/G C/T G/T 
 48 226  45  71 196  65 
	Genotypes:
    0     1     2     3 
51694 31808 54835 37433 

Read: genotypes_chrM_CEU_r24_nr.b36_fwd.txt.gz, 212 101 
Read: genotypes_chrM_JPT+CHB_r24_nr.b36_fwd.txt.gz, 206 101 
Read: genotypes_chrM_YRI_r24_nr.b36_fwd.txt.gz, 211 101 
	Position Intersect: 203 
	RS ID Intersect: 203 
	SNP alleles:
A/C A/G A/T C/G C/T 
  4 103   7   1  88 
	Genotypes:
    0     1     2     3 
30195    23 23990   602 

> 
> 
> # Add sample.annotation
> 
> dat <- read.table(sample.fn, header=TRUE, stringsAsFactors=FALSE)
> names(dat) <- c("FID", "IID", "father", "mother", "sex", "phenotype", "population")
> dat$sex[dat$sex==1] <- "M"
> dat$sex[dat$sex==2] <- "F"
> dat <- dat[match(sample.id, dat$IID),
+ 	c("FID", "IID", "father", "mother", "sex", "population")]
> table(dat$population, exclude=NULL)

 CEU  CHB  JPT  YRI <NA> 
  90   45   45   90    0 
> add.gdsn(newfile, "sample.annot", dat, compress="ZIP_RA.max", closezip=TRUE)
> 
> # show
> newfile
File: /home/postdoc/zhengx/my/CreateGDS/HapMap2_r24_nr_b36_fwd.gds
+    [  ] *
|--+ sample.id   { VStr8 270 ZIP_RA(26.06%) }
|--+ snp.id   { Int32 3735292 ZIP_RA(34.48%) }
|--+ snp.rs.id   { VStr8 3735292 ZIP_RA(32.93%) }
|--+ snp.chromosome   { VStr8 3735292 ZIP_RA(0.09%) }
|--+ snp.position   { Int32 3735292 ZIP_RA(73.35%) }
|--+ snp.allele   { VStr8 3735292 ZIP_RA(10.36%) }
|--+ genotype   { Bit2 270x3735292 ZIP_RA(39.10%) } *
|--+ sample.annot   [ data.frame ] *
|  |--+ FID   { VStr8 270 ZIP_RA(23.46%) }
|  |--+ IID   { VStr8 270 ZIP_RA(26.06%) }
|  |--+ father   { VStr8 270 ZIP_RA(23.89%) }
|  |--+ mother   { VStr8 270 ZIP_RA(23.22%) }
|  |--+ sex   { VStr8 270 ZIP_RA(18.89%) }
|  |--+ population   { VStr8 270 ZIP_RA(4.63%) }
> 
> # Close the GDS file
> closefn.gds(newfile)
> 
> cleanup.gds(gds.fn)
Clean up the fragments of GDS file:
	open the file "HapMap2_r24_nr_b36_fwd.gds" (size: 128988269).
	# of fragments in total: 179.
	save it to "HapMap2_r24_nr_b36_fwd.gds.tmp".
	rename "HapMap2_r24_nr_b36_fwd.gds.tmp" (size: 128986457).
	# of fragments in total: 28.
> 
> 
> 
> #########################################################################
> ##  Summarize the dataset
> 
> snpgdsSummary(gds.fn)
The file name: /home/postdoc/zhengx/my/CreateGDS/HapMap2_r24_nr_b36_fwd.gds 
The total number of samples: 270 
The total number of SNPs: 3735292 
SNP genotypes are stored in SNP-major mode (Sample X SNP).
> 
> 
> 
> #########################################################################
> ##  Session Info
> 
> sessionInfo()
R version 3.1.2 (2014-10-31)
Platform: x86_64-unknown-linux-gnu (64-bit)

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] SNPRelate_1.0.1 gdsfmt_1.2.2   
> 
> q("no")
> proc.time()
    user   system  elapsed 
1774.572  293.015 2467.819 
